"Changed column type" = Table.TransformColumnTypes(#"Expanded table column", {{"Source.Name", type text}, {"Line Item", type text}, {"Brand", type text}, {"Channel", type text}, {"SS_States: US States", type text}, {"SS_LOB: Export Metric", type text}, {"Period", type date}, {"Value", type number}}),
  #"Added Version" = Table.AddColumn(#"Changed column type", "Version", each Text.Middle([Source.Name], 44, 4), type text),
  #"Removed Columns2" = Table.RemoveColumns(#"Added Version", {"Source.Name"}),
  #"Replaced Value" = Table.ReplaceValue(#"Removed Columns2","State N/A","State NA",Replacer.ReplaceText,{"SS_States: US States"}),
  #"Added State" = Table.AddColumn(#"Replaced Value", "State", each if [#"SS_States: US States"] = "State NA" then "State NA" else if [#"SS_States: US States"] = "" then "State NA" else Text.Start([#"SS_States: US States"],2)),
  #"Added Distribution" = Table.TransformColumnTypes(Table.AddColumn(#"Added State", "Distribution", each if [Brand] = "LM" then  if [#"Channel"] = "Platform" then "LM Platform" else [#"Channel"] else [#"Channel"]), {{"Distribution", type text}}),
  #"Added Reinsurance" = Table.TransformColumnTypes(Table.AddColumn(#"Added Distribution", "Reinsurance", each "Direct"), {{"Reinsurance", type text}}),
  #"Added Segment" = Table.TransformColumnTypes(Table.AddColumn(#"Added Reinsurance", "Segment", each "PL Segment"), {{"Segment", type text}}),
  #"Renamed Columns" = Table.RenameColumns(#"Added Segment",{{"SS_LOB: Export Metric", "Line"}, {"Line Item", "Account"}}),
  #"Removed Brand & US States" = Table.RemoveColumns(#"Renamed Columns",{"Brand", "SS_States: US States"}),
  #"Changed Type1" = Table.TransformColumnTypes(#"Removed Brand & US States",{{"State", type text}, {"Value", type number}, {"Period", type date}}),
  #"Renamed Columns1" = Table.RenameColumns(#"Changed Type1", {{"Value", "Amount"}, {"Period", "Book Date"}})
in
  #"Renamed Columns1"
