
proc sql;

create table work.GL_state_alloc as

select
	BookDate,
	Reinsurance,
	State,
	Product,
	Line,
	GL_LOB,
	PRE_ALLOC_LOB,
	Vol_Invol,
	Distribution,
	Account,
	Amount1
from work.PCP_Final
where Amount1 not = 0 and Amount1 not is missing and 
Account not in 

('Administrative Expense Paid','Amortization of DAC','Capitalization of DAC',
           'Changes in ULAE Res','Chg Commissions Reserve','Chg in Admin Expense Reserve','Commissions Paid',
           'Other Acq. Exp. Chg Reserve','Other Acq. Exp. Paid','ULAE Paid Expenses','Billing Fees','Net Investment Income','Non-Traditional Revenue')


			OR ( 

Account in ('Administrative Expense Paid','Amortization of DAC','Capitalization of DAC',
           'Changes in ULAE Res','Chg Commissions Reserve','Chg in Admin Expense Reserve','Commissions Paid',
           'Other Acq. Exp. Chg Reserve','Other Acq. Exp. Paid','ULAE Paid Expenses','Billing Fees','Net Investment Income','Non-Traditional Revenue') 
AND State NOT in('State N/A','',' ') AND Reinsurance NOT in ('G1','G2','G3','G4') 


)

outer union corr

select 
	BookDate,
	Reinsurance,
	State1 as State,
	Product,
	Line,
	GL_LOB,
	PRE_ALLOC_LOB,
	Vol_Invol,
	Distribution,
	Account,
	Alloc_Amount as Amount1
from work.allocated_entries_new

outer union corr

select
	BookDate,
	Reinsurance,
	State,
	Product,
	Line,
	GL_LOB,
	PRE_ALLOC_LOB,
	Vol_Invol,
	Distribution,
	Account,
	Amount1
from work.PCP_Final
where Reinsurance in ('G1','G2','G3','G4')

;quit;
