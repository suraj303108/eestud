let
  Source = SharePoint.Files("https://libertymutual.sharepoint.com/sites/GRMFSDataStrategy", [ApiVersion = 15]),
  Navigation = Source{[#"Folder Path" = "https://libertymutual.sharepoint.com/sites/GRMFSDataStrategy/Shared Documents/General/Final Plan/USRM Versions SC OP/", Name = "SC Op Metrics Export - Current What If PBI.csv"]}[Content],
  #"Imported CSV" = Csv.Document(Navigation, [Delimiter = ",", Columns = 7, Encoding = 65001, QuoteStyle = QuoteStyle.None]),
  #"Promoted Headers" = Table.PromoteHeaders(#"Imported CSV", [PromoteAllScalars=true]),
  #"Renamed Columns" = Table.RenameColumns(#"Promoted Headers",{{"Line Item", "Account"}, {"SS: Segment: BL", "Segment"}, {"SS_LOB: BL Topline", "Line"}, {"SS_Channel: BL", "Channel"}, {"SS_States: US States Reporting", "States"}, {"Value", "Amount"}, {"Period", "Book Date"}}),
  #"Added State" = Table.AddColumn(#"Renamed Columns", "State", each if [#"States"] = "" then "State NA" else Text.Start([#"States"], 2)),
  #"Added Distribution" = Table.AddColumn(#"Added State", "Distribution", each [#"Segment"] & "-" & [#"Channel"]),
  #"Added Reinsurance" = Table.AddColumn(#"Added Distribution", "Reinsurance", each "RI_NA"),
  #"Added Brand" = Table.AddColumn(#"Added Reinsurance", "Brand", each if [Channel] = "IA (Vol) State Auto" then "SA" else "LM"),
  #"Removed Columns3" = Table.RemoveColumns(#"Added Brand", {"States"}),
  #"Changed Type1" = Table.TransformColumnTypes(#"Removed Columns3",{{"State", type text}, {"Distribution", type text}, {"Reinsurance", type text}, {"Brand", type text}, {"Book Date", type date}, {"Amount", type number}}),
  #"Renaming NB Rate Numerator value" = Table.ReplaceValue(#"Changed Type1", "NB Summary Num: Final Rate", "NB Rate Numerator", Replacer.ReplaceText, {"Account"}),
  #"Renaming RB Rate Numerator value" = Table.ReplaceValue(#"Renaming NB Rate Numerator value", "RB Summary Num: Final Rate", "RB Rate Numerator", Replacer.ReplaceText, {"Account"}),
  #"Renaming NB Rate Denominator value" = Table.ReplaceValue(#"Renaming RB Rate Numerator value", "NB Summary Denom: Final Rate", "NB Rate Denominator", Replacer.ReplaceText, {"Account"}),
  #"Renaming RB Rate Denominator value" = Table.ReplaceValue(#"Renaming NB Rate Denominator value", "RB Summary Denom: Final Rate", "RB Rate Denominator", Replacer.ReplaceText, {"Account"}),
  #"Filtered rows 1" = Table.SelectRows(#"Renaming RB Rate Denominator value", each [Book Date] > #date(2024, 12, 31))
in
  #"Filtered rows 1"
