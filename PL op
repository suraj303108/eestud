import pandas as pd

# Load your data into a DataFrame (replace 'data_source' with your actual data source)
df = pd.read_csv('data_source.csv')

# Add custom column 'Product'
df['Product'] = 'PRO'

# Change type of 'Product' column to text (not needed in Python as pandas handles it)
df['Product'] = df['Product'].astype(str)

# Filter rows based on 'Account' column values
filtered_df = df[df['Account'].isin([
    'NB Written Premium', 
    'RB Written Premium', 
    'Written Premium', 
    'Audit & Retro Written Premium', 
    'CUNA - NB WP', 
    'CUNA - RB WP', 
    'Written Premium Renewal Business'
])]

# Rename columns
filtered_df.rename(columns={'Amount': 'oldAmount', 'Account': 'oldAccount'}, inplace=True)

# Add custom columns 'Amount' and 'Account'
filtered_df['Amount'] = -filtered_df['oldAmount']
filtered_df['Account'] = 'Earned Premium'

# Change types of new columns (not needed in Python as pandas handles it)
filtered_df['Amount'] = filtered_df['Amount'].astype(float)
filtered_df['Account'] = filtered_df['Account'].astype(str)

# Remove old columns
filtered_df.drop(columns=['oldAccount', 'oldAmount'], inplace=True)

# Display the final DataFrame
